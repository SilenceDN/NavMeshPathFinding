var NavMeshPathFinding=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t,i){return t(i={exports:{}},i.exports),i.exports}var e=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(o.prototype.setValues=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),this.x=t||0,this.y=i||0,this},o.prototype.offset=function(t,i){return this.x+=t,this.y+=i,this},o.polar=function(t,i,e){return(e=e||new o).x=t*Math.cos(i),e.y=t*Math.sin(i),e},o.interpolate=function(t,i,e,n){return(n=n||new o).x=i.x+e*(t.x-i.x),n.y=i.y+e*(t.y-i.y),n},o.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},o);function o(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.setValues(t,i)}i.Point=e});t(e);e.Point;var o=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(o.prototype.setValues=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),this.x=t||0,this.y=i||0,this},o.prototype.offset=function(t,i){return this.x+=t,this.y+=i,this},o.polar=function(t,i,e){return(e=e||new o).x=t*Math.cos(i),e.y=t*Math.sin(i),e},o.interpolate=function(t,i,e,n){return(n=n||new o).x=i.x+e*(t.x-i.x),n.y=i.y+e*(t.y-i.y),n},o.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},o);function o(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.setValues(t,i)}i.Point=e});t(o);o.Point;var n=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),n.prototype.setVector2f=function(t){this.x=t.x,this.y=t.y},n.prototype.getAngela=function(){return-Math.atan2(this.y,this.x)},n.prototype.length=function(){return Math.sqrt(this.lengthSquared())},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},n.prototype.distanceSquared=function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.negateLocal=function(){return this.x-=this.x,this.y-=this.y,this},n.prototype.add=function(t){return null==t?null:new n(this.x+t.x,this.y+t.y)},n.prototype.addLocal=function(t){return null==t?null:(this.x+=t.x,this.y+=t.y,this)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.subtractLocal=function(t){return null==t?null:(this.x-=t.x,this.y-=t.y,this)},n.prototype.dot=function(t){return null==t?0:this.x*t.x+this.y*t.y},n.prototype.mult=function(t){return new n(this.x*t,this.y*t)},n.prototype.multLocal=function(t){return this.x*=t,this.y*=t,this},n.prototype.multLocalV=function(t){return null==t?null:(this.x*=t.x,this.y*=t.y,this)},n.prototype.multV=function(t,i){return null==i&&(i=new n),i.x=this.x*t,i.y=this.y*t,i},n.prototype.divide=function(t){return new n(this.x/t,this.y/t)},n.prototype.divideLocal=function(t){return this.x/=t,this.y/=t,this},n.prototype.normalize=function(){var t=this.length();return 0!==t?this.divide(t):this.divide(1)},n.prototype.normalizeLocal=function(){var t=this.length();return 0!==t?this.divideLocal(t):this.divideLocal(1)},n.prototype.smallestAngleBetween=function(t){var i=this.dot(t);return Math.acos(i)},n.prototype.angleBetween=function(t){return Math.atan2(t.y,t.x)-Math.atan2(this.y,this.x)},n.prototype.interpolate=function(t,i){this.x=(1-i)*this.x+i*t.x,this.y=(1-i)*this.y+i*t.y},n.prototype.zero=function(){this.x=this.y=0},n.prototype.toArray=function(t){return null==t&&(t=[]),t[0]=this.x,t[1]=this.y,t},n.prototype.rotateAroundOrigin=function(t,i){i&&(t=-t);var e=Math.cos(t)*this.x-Math.sin(t)*this.y,n=Math.sin(t)*this.x+Math.cos(t)*this.y;this.x=e,this.y=n},n.prototype.equals=function(t,i){return void 0===i&&(i=1e-6),Math.abs(this.x-t.x)<i&&Math.abs(this.y-t.y)<i},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.toPoint=function(){return new o.Point(this.x,this.y)},n.prototype.toString=function(){return"("+this.x+","+this.y+")"},n);function n(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}i.Vector2f=e});t(n);n.Vector2f;var r=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.ON_LINE=0,n.LEFT_SIDE=1,n.RIGHT_SIDE=2,n);function n(){}i.PointClassification=e});t(r);r.PointClassification;var s=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.COLLINEAR=0,n.LINES_INTERSECT=1,n.SEGMENTS_INTERSECT=2,n.A_BISECTS_B=3,n.B_BISECTS_A=4,n.PARALELL=5,n);function n(){}i.LineClassification=e});t(s);s.LineClassification;var d=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),n.prototype.setVector2f=function(t){this.x=t.x,this.y=t.y},n.prototype.getAngela=function(){return-Math.atan2(this.y,this.x)},n.prototype.length=function(){return Math.sqrt(this.lengthSquared())},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},n.prototype.distanceSquared=function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.negateLocal=function(){return this.x-=this.x,this.y-=this.y,this},n.prototype.add=function(t){return null==t?null:new n(this.x+t.x,this.y+t.y)},n.prototype.addLocal=function(t){return null==t?null:(this.x+=t.x,this.y+=t.y,this)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.subtractLocal=function(t){return null==t?null:(this.x-=t.x,this.y-=t.y,this)},n.prototype.dot=function(t){return null==t?0:this.x*t.x+this.y*t.y},n.prototype.mult=function(t){return new n(this.x*t,this.y*t)},n.prototype.multLocal=function(t){return this.x*=t,this.y*=t,this},n.prototype.multLocalV=function(t){return null==t?null:(this.x*=t.x,this.y*=t.y,this)},n.prototype.multV=function(t,i){return null==i&&(i=new n),i.x=this.x*t,i.y=this.y*t,i},n.prototype.divide=function(t){return new n(this.x/t,this.y/t)},n.prototype.divideLocal=function(t){return this.x/=t,this.y/=t,this},n.prototype.normalize=function(){var t=this.length();return 0!==t?this.divide(t):this.divide(1)},n.prototype.normalizeLocal=function(){var t=this.length();return 0!==t?this.divideLocal(t):this.divideLocal(1)},n.prototype.smallestAngleBetween=function(t){var i=this.dot(t);return Math.acos(i)},n.prototype.angleBetween=function(t){return Math.atan2(t.y,t.x)-Math.atan2(this.y,this.x)},n.prototype.interpolate=function(t,i){this.x=(1-i)*this.x+i*t.x,this.y=(1-i)*this.y+i*t.y},n.prototype.zero=function(){this.x=this.y=0},n.prototype.toArray=function(t){return null==t&&(t=[]),t[0]=this.x,t[1]=this.y,t},n.prototype.rotateAroundOrigin=function(t,i){i&&(t=-t);var e=Math.cos(t)*this.x-Math.sin(t)*this.y,n=Math.sin(t)*this.x+Math.cos(t)*this.y;this.x=e,this.y=n},n.prototype.equals=function(t,i){return void 0===i&&(i=1e-6),Math.abs(this.x-t.x)<i&&Math.abs(this.y-t.y)<i},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.toPoint=function(){return new o.Point(this.x,this.y)},n.prototype.toString=function(){return"("+this.x+","+this.y+")"},n);function n(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}i.Vector2f=e});t(d);d.Vector2f;var x=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.ON_LINE=0,n.LEFT_SIDE=1,n.RIGHT_SIDE=2,n);function n(){}i.PointClassification=e});t(x);x.PointClassification;var f=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.COLLINEAR=0,n.LINES_INTERSECT=1,n.SEGMENTS_INTERSECT=2,n.A_BISECTS_B=3,n.B_BISECTS_A=4,n.PARALELL=5,n);function n(){}i.LineClassification=e});t(f);f.LineClassification;var h=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.setPointA=function(t){this.pointA=t.clone(),this.m_NormalCalculated=!1},n.prototype.setPointB=function(t){this.pointB=t.clone(),this.m_NormalCalculated=!1},n.prototype.setPoints=function(t,i){this.pointA=t.clone(),this.pointB=i.clone(),this.m_NormalCalculated=!1},n.prototype.getNormal=function(){return this.m_NormalCalculated||this.computeNormal(),this.m_Normal},n.prototype.signedDistance=function(t){this.m_NormalCalculated||this.computeNormal();var i=t.subtract(this.pointA);return new d.Vector2f(i.x,i.y).dot(this.m_Normal)},n.prototype.classifyPoint=function(t,i){void 0===i&&(i=1e-6);var e=x.PointClassification.ON_LINE,n=this.signedDistance(t);return i<n?e=x.PointClassification.RIGHT_SIDE:n<-i&&(e=x.PointClassification.LEFT_SIDE),e},n.prototype.intersection=function(t,i){void 0===i&&(i=null);var e=(t.pointB.y-t.pointA.y)*(this.pointB.x-this.pointA.x)-(t.pointB.x-t.pointA.x)*(this.pointB.y-this.pointA.y),n=(t.pointB.x-t.pointA.x)*(this.pointA.y-t.pointA.y)-(t.pointB.y-t.pointA.y)*(this.pointA.x-t.pointA.x),o=(t.pointA.x-this.pointA.x)*(this.pointB.y-this.pointA.y)-(t.pointA.y-this.pointA.y)*(this.pointB.x-this.pointA.x);if(0==e)return 0===n&&0===o?f.LineClassification.COLLINEAR:f.LineClassification.PARALELL;n/=e,o/=e;var r=this.pointA.x+n*(this.pointB.x-this.pointA.x),s=this.pointA.y+n*(this.pointB.y-this.pointA.y);return null!=i&&(i.x=r,i.y=s),0<=n&&n<=1&&0<=o&&o<=1?f.LineClassification.SEGMENTS_INTERSECT:0<=o&&o<=1?f.LineClassification.A_BISECTS_B:0<=n&&n<=1?f.LineClassification.B_BISECTS_A:f.LineClassification.LINES_INTERSECT},n.prototype.getPointA=function(){return this.pointA},n.prototype.getPointB=function(){return this.pointB},n.prototype.length=function(){var t=this.pointB.x-this.pointA.x,i=this.pointB.y-this.pointA.y;return t*=t,i*=i,Math.sqrt(t+i)},n.prototype.getDirection=function(){var t=this.pointB.subtract(this.pointA);return new d.Vector2f(t.x,t.y).normalize()},n.prototype.computeNormal=function(){this.m_Normal=this.getDirection();var t=this.m_Normal.y;this.m_Normal.y=this.m_Normal.x,this.m_Normal.x=-t,this.m_NormalCalculated=!0},n.prototype.equals=function(t){return this.pointA.equals(t.getPointA())&&this.pointB.equals(t.getPointB())||this.pointA.equals(t.getPointB())&&this.pointB.equals(t.getPointA())},n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone())},n.prototype.toString=function(){return"Line:"+this.pointA+" -> "+this.pointB},n);function n(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.m_NormalCalculated=!1,this.pointA=t.clone(),this.pointB=i.clone(),this.m_NormalCalculated=!1}i.Line2D=e});t(h);h.Line2D;var _=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.setPointA=function(t){this.pointA=t.clone(),this.m_NormalCalculated=!1},n.prototype.setPointB=function(t){this.pointB=t.clone(),this.m_NormalCalculated=!1},n.prototype.setPoints=function(t,i){this.pointA=t.clone(),this.pointB=i.clone(),this.m_NormalCalculated=!1},n.prototype.getNormal=function(){return this.m_NormalCalculated||this.computeNormal(),this.m_Normal},n.prototype.signedDistance=function(t){this.m_NormalCalculated||this.computeNormal();var i=t.subtract(this.pointA);return new d.Vector2f(i.x,i.y).dot(this.m_Normal)},n.prototype.classifyPoint=function(t,i){void 0===i&&(i=1e-6);var e=x.PointClassification.ON_LINE,n=this.signedDistance(t);return i<n?e=x.PointClassification.RIGHT_SIDE:n<-i&&(e=x.PointClassification.LEFT_SIDE),e},n.prototype.intersection=function(t,i){void 0===i&&(i=null);var e=(t.pointB.y-t.pointA.y)*(this.pointB.x-this.pointA.x)-(t.pointB.x-t.pointA.x)*(this.pointB.y-this.pointA.y),n=(t.pointB.x-t.pointA.x)*(this.pointA.y-t.pointA.y)-(t.pointB.y-t.pointA.y)*(this.pointA.x-t.pointA.x),o=(t.pointA.x-this.pointA.x)*(this.pointB.y-this.pointA.y)-(t.pointA.y-this.pointA.y)*(this.pointB.x-this.pointA.x);if(0==e)return 0===n&&0===o?f.LineClassification.COLLINEAR:f.LineClassification.PARALELL;n/=e,o/=e;var r=this.pointA.x+n*(this.pointB.x-this.pointA.x),s=this.pointA.y+n*(this.pointB.y-this.pointA.y);return null!=i&&(i.x=r,i.y=s),0<=n&&n<=1&&0<=o&&o<=1?f.LineClassification.SEGMENTS_INTERSECT:0<=o&&o<=1?f.LineClassification.A_BISECTS_B:0<=n&&n<=1?f.LineClassification.B_BISECTS_A:f.LineClassification.LINES_INTERSECT},n.prototype.getPointA=function(){return this.pointA},n.prototype.getPointB=function(){return this.pointB},n.prototype.length=function(){var t=this.pointB.x-this.pointA.x,i=this.pointB.y-this.pointA.y;return t*=t,i*=i,Math.sqrt(t+i)},n.prototype.getDirection=function(){var t=this.pointB.subtract(this.pointA);return new d.Vector2f(t.x,t.y).normalize()},n.prototype.computeNormal=function(){this.m_Normal=this.getDirection();var t=this.m_Normal.y;this.m_Normal.y=this.m_Normal.x,this.m_Normal.x=-t,this.m_NormalCalculated=!0},n.prototype.equals=function(t){return this.pointA.equals(t.getPointA())&&this.pointB.equals(t.getPointB())||this.pointA.equals(t.getPointB())&&this.pointB.equals(t.getPointA())},n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone())},n.prototype.toString=function(){return"Line:"+this.pointA+" -> "+this.pointB},n);function n(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.m_NormalCalculated=!1,this.pointA=t.clone(),this.pointB=i.clone(),this.m_NormalCalculated=!1}i.Line2D=e});t(_);_.Line2D;var a=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.setPoints=function(t,i,e){this.pointA=t.clone(),this.pointB=i.clone(),this.pointC=e.clone(),this.dataCalculated=!1},n.prototype.calculateData=function(){null==this._center?this._center=this.pointA.clone():this._center.setVector2f(this.pointA),this._center.addLocal(this.pointB).addLocal(this.pointC).multLocal(1/3),null==this._sides&&(this._sides=new Array),this._sides[this.SIDE_AB]=new _.Line2D(this.pointA,this.pointB),this._sides[this.SIDE_BC]=new _.Line2D(this.pointB,this.pointC),this._sides[this.SIDE_CA]=new _.Line2D(this.pointC,this.pointA),this.dataCalculated=!0},n.prototype.getVertex=function(t){switch(t){case 0:return this.pointA;case 1:return this.pointB;case 2:return this.pointC;default:return null}},n.prototype.setVertex=function(t,i){switch(t){case 0:this.pointA=i.clone();break;case 1:this.pointB=i.clone();break;case 2:this.pointC=i.clone()}this.dataCalculated=!1},n.prototype.getSide=function(t){return!1===this.dataCalculated&&this.calculateData(),this.sides[t]},n.prototype.isPointIn=function(t){!1===this.dataCalculated&&this.calculateData();for(var i=0,e=0;e<3;e++)this.sides[e].classifyPoint(t,this.EPSILON)!==x.PointClassification.LEFT_SIDE&&i++;return 3===i},n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone(),this.pointC.clone())},n.prototype.toString=function(){return"Triangle:"+this.pointA+" -> "+this.pointB+" -> "+this.pointC},Object.defineProperty(n.prototype,"pointA",{get:function(){return this._pointA},set:function(t){this._pointA=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pointB",{get:function(){return this._pointB},set:function(t){this._pointB=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pointC",{get:function(){return this._pointC},set:function(t){this._pointC=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return!1===this.dataCalculated&&this.calculateData(),this._center},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sides",{get:function(){return this._sides},enumerable:!0,configurable:!0}),n);function n(t,i,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===e&&(e=null),this.EPSILON=1e-6,this.SIDE_AB=0,this.SIDE_BC=1,this.SIDE_CA=2,this.dataCalculated=!1,this.pointA=t.clone(),this.pointB=i.clone(),this.pointC=e.clone(),this.dataCalculated=!1}i.Triangle=e});t(a);a.Triangle;var l=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(r.prototype.setValues=function(t,i,e,n){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=i,this.width=e,this.height=n,this},r.prototype.extend=function(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t+e>this.x+this.width&&(this.width=t+e-this.x),i+n>this.y+this.height&&(this.height=i+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),i<this.y&&(this.height+=this.y-i,this.y=i),this},r.prototype.pad=function(t,i,e,n){return this.x-=i,this.y-=t,this.width+=i+n,this.height+=t+e,this},r.prototype.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},r.prototype.contains=function(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t>=this.x&&t+e<=this.x+this.width&&i>=this.y&&i+n<=this.y+this.height},r.prototype.containsRect=function(t){return t.x>=this.x&&t.x+t.width<=this.x+this.width&&t.y>=this.y&&t.y+t.height<=this.y+this.height},r.prototype.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},r.prototype.intersection=function(t){var i=t.x,e=t.y,n=i+t.width,o=e+t.height;return this.x>i&&(i=this.x),this.y>e&&(e=this.y),this.x+this.width<n&&(n=this.x+this.width),this.y+this.height<o&&(o=this.y+this.height),n<=i||o<=e?null:new r(i,e,n-i,o-e)},r.prototype.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},r);function r(t,i,e,n){this.setValues(t,i,e,n)}i.Rectangle=e});t(l);l.Rectangle;var u=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.setPoints=function(t,i,e){this.pointA=t.clone(),this.pointB=i.clone(),this.pointC=e.clone(),this.dataCalculated=!1},n.prototype.calculateData=function(){null==this._center?this._center=this.pointA.clone():this._center.setVector2f(this.pointA),this._center.addLocal(this.pointB).addLocal(this.pointC).multLocal(1/3),null==this._sides&&(this._sides=new Array),this._sides[this.SIDE_AB]=new _.Line2D(this.pointA,this.pointB),this._sides[this.SIDE_BC]=new _.Line2D(this.pointB,this.pointC),this._sides[this.SIDE_CA]=new _.Line2D(this.pointC,this.pointA),this.dataCalculated=!0},n.prototype.getVertex=function(t){switch(t){case 0:return this.pointA;case 1:return this.pointB;case 2:return this.pointC;default:return null}},n.prototype.setVertex=function(t,i){switch(t){case 0:this.pointA=i.clone();break;case 1:this.pointB=i.clone();break;case 2:this.pointC=i.clone()}this.dataCalculated=!1},n.prototype.getSide=function(t){return!1===this.dataCalculated&&this.calculateData(),this.sides[t]},n.prototype.isPointIn=function(t){!1===this.dataCalculated&&this.calculateData();for(var i=0,e=0;e<3;e++)this.sides[e].classifyPoint(t,this.EPSILON)!==x.PointClassification.LEFT_SIDE&&i++;return 3===i},n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone(),this.pointC.clone())},n.prototype.toString=function(){return"Triangle:"+this.pointA+" -> "+this.pointB+" -> "+this.pointC},Object.defineProperty(n.prototype,"pointA",{get:function(){return this._pointA},set:function(t){this._pointA=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pointB",{get:function(){return this._pointB},set:function(t){this._pointB=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pointC",{get:function(){return this._pointC},set:function(t){this._pointC=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return!1===this.dataCalculated&&this.calculateData(),this._center},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sides",{get:function(){return this._sides},enumerable:!0,configurable:!0}),n);function n(t,i,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===e&&(e=null),this.EPSILON=1e-6,this.SIDE_AB=0,this.SIDE_BC=1,this.SIDE_CA=2,this.dataCalculated=!1,this.pointA=t.clone(),this.pointB=i.clone(),this.pointC=e.clone(),this.dataCalculated=!1}i.Triangle=e});t(u);u.Triangle;var y=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(r.prototype.setValues=function(t,i,e,n){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=i,this.width=e,this.height=n,this},r.prototype.extend=function(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t+e>this.x+this.width&&(this.width=t+e-this.x),i+n>this.y+this.height&&(this.height=i+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),i<this.y&&(this.height+=this.y-i,this.y=i),this},r.prototype.pad=function(t,i,e,n){return this.x-=i,this.y-=t,this.width+=i+n,this.height+=t+e,this},r.prototype.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},r.prototype.contains=function(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t>=this.x&&t+e<=this.x+this.width&&i>=this.y&&i+n<=this.y+this.height},r.prototype.containsRect=function(t){return t.x>=this.x&&t.x+t.width<=this.x+this.width&&t.y>=this.y&&t.y+t.height<=this.y+this.height},r.prototype.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},r.prototype.intersection=function(t){var i=t.x,e=t.y,n=i+t.width,o=e+t.height;return this.x>i&&(i=this.x),this.y>e&&(e=this.y),this.x+this.width<n&&(n=this.x+this.width),this.y+this.height<o&&(o=this.y+this.height),n<=i||o<=e?null:new r(i,e,n-i,o-e)},r.prototype.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},r);function r(t,i,e,n){this.setValues(t,i,e,n)}i.Rectangle=e});t(y);y.Rectangle;var p=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.createDelaunay=function(t){this.initData(t);var i,e=this.getInitOutEdge();this.lineV.push(e);do{i=this.lineV.pop();var n,o,r,s,h=this.findDT(i);null!=h&&(n=new _.Line2D(i.getPointA(),h),o=new _.Line2D(h,i.getPointB()),r=new u.Triangle(i.getPointA(),i.getPointB(),h),this.triangleV.push(r),s=void 0,this.indexOfVector(n,this.edgeV)<0&&(-1<(s=this.indexOfVector(n,this.lineV))?this.lineV.splice(s,1):this.lineV.push(n)),this.indexOfVector(o,this.edgeV)<0&&(-1<(s=this.indexOfVector(o,this.lineV))?this.lineV.splice(s,1):this.lineV.push(o)))}while(0<this.lineV.length);return this.triangleV},n.prototype.initData=function(t){var i;this.vertexV=new Array,this.edgeV=new Array;for(var e=0;e<t.length;e++)i=t[e],this.putVertex(this.vertexV,i.vertexV),this.putEdge(this.edgeV,i.vertexV);this.outEdgeVecNmu=t[0].vertexNmu,this.lineV=new Array,this.triangleV=new Array},n.prototype.getInitOutEdge=function(){var t,i=this.edgeV[0],e=0;do{t=!1,e++;for(var n=0,o=this.vertexV;n<o.length;n++){var r=o[n];if(r.equals(i.getPointA())||r.equals(i.getPointB()),i.classifyPoint(r,this.EPSILON)===x.PointClassification.ON_LINE){t=!0,i=this.edgeV[e];break}}}while(t&&e<this.outEdgeVecNmu-1);return i},n.prototype.putVertex=function(i,t){t.forEach(function(t){i.push(t)})},n.prototype.putEdge=function(t,i){if(!(i.length<3)){for(var e,n=i[0],o=1;o<i.length;o++)e=i[o],t.push(new _.Line2D(n,e)),n=e;e=i[0],t.push(new _.Line2D(n,e))}},n.prototype.indexOfVector=function(t,i){for(var e=0;e<i.length;e++)if(i[e].equals(t))return e;return-1},n.prototype.findDT=function(i){var t=i.getPointA(),e=i.getPointB(),n=new Array,o=this;if(this.vertexV.forEach(function(t){o.isVisiblePointOfLine(t,i)&&n.push(t)}),0===n.length)return null;var r=n[0],s=!1,h={};do{s=!1;for(var a=this.circumCircle(t,e,r),l=this.circleBounds(a),u=this.lineAngle(t,r,e),p=0,c=n;p<c.length;p++){var f=c[p];if(!(f.equals(t)||f.equals(e)||f.equals(r))&&!1!==l.contains(f.x,f.y)){var y=this.lineAngle(t,f,e);if(Math.abs(y)>Math.abs(u)){r=f,s=!0,h={};break}Math.abs(y)==Math.abs(u)&&(h[Math.abs(y)]=0<y?f:r)}}}while(s);return h[this.lineAngle(t,r,e)]||r},n.prototype.lineAngle=function(t,i,e){var n,o=t.x-i.x,r=t.y-i.y,s=e.x-i.x,h=e.y-i.y,a=o*s+r*h,l=(o*o+r*r)*(s*s+h*h);return 1<=(a/=Math.sqrt(l))?0:a<=-1?-Math.PI:(n=Math.acos(a),0<o*h-r*s?n:-n)},n.prototype.circleBounds=function(t){return new y.Rectangle(t.center.x-t.r,t.center.y-t.r,2*t.r,2*t.r)},n.prototype.circumCircle=function(t,i,e){var n,o,r,s,h,a,l,u,p,c,f,y;return Math.abs(t.y-i.y)<this.EPSILON&&Math.abs(i.y-e.y)<this.EPSILON?null:(n=-(i.x-t.x)/(i.y-t.y),o=-(e.x-i.x)/(e.y-i.y),r=(t.x+i.x)/2,s=(i.x+e.x)/2,h=(t.y+i.y)/2,a=(i.y+e.y)/2,f=Math.abs(i.y-t.y)<this.EPSILON?o*((c=(i.x+t.x)/2)-s)+a:Math.abs(e.y-i.y)<this.EPSILON?n*((c=(e.x+i.x)/2)-r)+h:n*((c=(n*r-o*s+a-h)/(n-o))-r)+h,p=(l=i.x-c)*l+(u=i.y-f)*u,y=Math.sqrt(p),new v(new d.Vector2f(c,f),y))},n.prototype.isVisiblePointOfLine=function(t,i){return!t.equals(i.getPointA())&&!t.equals(i.getPointB())&&i.classifyPoint(t,this.EPSILON)===x.PointClassification.RIGHT_SIDE&&!1!==this.isVisibleIn2Point(i.getPointA(),t)&&!1!==this.isVisibleIn2Point(i.getPointB(),t)},n.prototype.isVisibleIn2Point=function(t,i){for(var e=new _.Line2D(t,i),n=new d.Vector2f,o=0,r=this.edgeV;o<r.length;o++){var s=r[o];if(e.intersection(s,n)===f.LineClassification.SEGMENTS_INTERSECT&&!t.equals(n)&&!i.equals(n))return!1}return!0},n);function n(){this.EPSILON=1e-6}i.Delaunay=e;var v=function(t,i){this.center=t,this.r=i}});t(p);p.Delaunay;var c=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var p=(e.prototype.toString=function(){return this.v.toString()+"--\x3e交点："+this.i+"出点："+this.o+"主："+this.isMain+"处理："+this.p},e);function e(t,i,e){this.p=!1,this.o=!1,this.v=t,this.i=i,this.isMain=e}var n=(c.prototype.isSimplicity=function(){for(var t=new Array,i=this.vertexV.length-1,e=0;e<i;e++)t.push(new _.Line2D(this.vertexV[e],this.vertexV[e+1]));t.push(new _.Line2D(this.vertexV[i],this.vertexV[0]));for(var n=new d.Vector2f,o=0,r=t;o<r.length;o++)for(var s=r[o],h=0;h<t.length;h++)if(!s.equals(t[h])&&s.intersection(t[h],n)===f.LineClassification.SEGMENTS_INTERSECT&&!(n.equals(s.getPointA())||n.equals(s.getPointB())||n.equals(t[h].getPointA())||n.equals(t[h].getPointB())))return!1;return!0},c.prototype.cw=function(){!1===this.isCW()&&this.vertexV.reverse()},c.prototype.isCW=function(){if(null==this.vertexV||this.vertexV.length<0)return!1;for(var t=this.vertexV[0],i=0,e=1;e<this.vertexV.length;e++)(t.y>this.vertexV[e].y||t.y===this.vertexV[e].y&&t.x>this.vertexV[e].x)&&(t=this.vertexV[e],i=e);var n=0<=i-1?i-1:this.vertexV.length-1,o=i+1>=this.vertexV.length?0:i+1,r=this.vertexV[n],s=this.vertexV[o];return c.multiply(r,s,t)<0},c.multiply=function(t,i,e){return(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)},c.prototype.rectangle=function(){if(null==this.vertexV||this.vertexV.length<0)return null;if(null!=this.rect)return this.rect;for(var t,i=this.vertexV[0].x,e=this.vertexV[0].x,n=this.vertexV[0].y,o=this.vertexV[0].y,r=1;r<this.vertexV.length;r++)(t=this.vertexV[r]).x<i&&(i=t.x),t.x>e&&(e=t.x),t.y<n&&(n=t.y),t.y>o&&(o=t.y);return this.rect=new y.Rectangle(i,n,e-i,o-n),this.rect},c.prototype.union=function(t){var i=this.rectangle().intersection(t.rectangle());if(!i||!0===i.isEmpty())return null;for(var e,n=new Array,o=new Array,r=0;r<this.vertexV.length;r++)e=new p(this.vertexV[r],!1,!0),0<r&&(n[r-1].next=e),n.push(e);for(var s=0;s<t.vertexV.length;s++)e=new p(t.vertexV[s],!1,!1),0<s&&(o[s-1].next=e),o.push(e);return 0<c.intersectPoint(n,o)?this.linkToPolygon(n,o):null},c.prototype.complement=function(t){var i=this.rectangle();if(i.containsRect(t.rectangle()))return t;var e=i.intersection(t.rectangle());if(!e||!0===e.isEmpty())return null;for(var n,o=new Array,r=new Array,s=0;s<this.vertexV.length;s++)n=new p(this.vertexV[s],!1,!0),0<s&&(o[s-1].next=n),o.push(n);for(var h=0;h<t.vertexV.length;h++)n=new p(t.vertexV[h],!1,!1),0<h&&(r[h-1].next=n),r.push(n);if(0<c.intersectPoint(o,r)){var a=new Array;r.forEach(function(t){i.contains(t.v.x,t.v.y)&&a.push(t.v)});var l=new c(a.length,a);return l.cw(),l}return null},c.prototype.linkToPolygon=function(e,n){var o=new Array;return e.forEach(function(t){if(!0===t.i&&!1===t.p){for(var i=new Array;t&&((t.p=!0)===t.i&&(!(t.other.p=!0)===t.o?!0===t.isMain&&(t=t.other):!1===t.isMain&&(t=t.other)),i.push(t.v),!(t=null==t.next?t.isMain?e[0]:n[0]:t.next).v.equals(i[0])););o.push(new c(i.length,i))}}),o},c.intersectPoint=function(t,i){for(var e,n,o,r,s,h=0,a=t[0];null!=a;){for(n=null==a.next?new _.Line2D(a.v,t[0].v):new _.Line2D(a.v,a.next.v),e=i[0],s=!1;null!=e;){if(o=null==e.next?new _.Line2D(e.v,i[0].v):new _.Line2D(e.v,e.next.v),r=new d.Vector2f,n.intersection(o,r)===f.LineClassification.SEGMENTS_INTERSECT&&-1===c.getNodeIndex(t,r)){h++;var l=new p(r,!0,!0),u=new p(r,!0,!1);t.push(l),i.push(u),((l.other=u).other=l).next=a.next,a.next=l,u.next=e.next,e.next=u,n.classifyPoint(o.getPointB())===x.PointClassification.RIGHT_SIDE&&(l.o=!0,u.o=!0),s=!0;break}e=e.next}!1===s&&(a=a.next)}return h},c.getNodeIndex=function(t,i){for(var e=0;e<t.length;e++)if(t[e].v.equals(i))return e;return-1},c.prototype.toString=function(){for(var t="Polygon:",i=0;i<this.vertexV.length;i++)t+=" -> "+this.vertexV[i];return t},c);function c(t,i){this.vertexNmu=t,this.vertexV=i}i.Polygon=n});t(c);c.Polygon;var v=function(t,i){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};var g=function(){return(g=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};function P(t){var i="function"==typeof Symbol&&Symbol.iterator,e=i&&t[i],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(t,i){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,o,r=e.call(t),s=[];try{for(;(void 0===i||0<i--)&&!(n=r.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(o)throw o.error}}return s}function A(t){return this instanceof A?(this.v=t,this):new A(t)}var m=Object.freeze({__proto__:null,__extends:function(t,i){function e(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},get __assign(){return g},__rest:function(t,i){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(e[n[o]]=t[n[o]]);return e},__decorate:function(t,i,e,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,i,e,n);else for(var h=t.length-1;0<=h;h--)(o=t[h])&&(s=(r<3?o(s):3<r?o(i,e,s):o(i,e))||s);return 3<r&&s&&Object.defineProperty(i,e,s),s},__param:function(e,n){return function(t,i){n(t,i,e)}},__metadata:function(t,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,i)},__awaiter:function(t,s,h,a){return new(h=h||Promise)(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a.throw(t))}catch(t){i(t)}}function r(t){var i;t.done?e(t.value):((i=t.value)instanceof h?i:new h(function(t){t(i)})).then(n,o)}r((a=a.apply(t,s||[])).next())})},__generator:function(e,n){var o,r,s,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(i){return function(t){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(!(s=0<(s=h.trys).length&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=n.call(e,h)}catch(t){i=[6,t],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,t])}}},__exportStar:function(t,i){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])},__values:P,__read:w,__spread:function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(w(arguments[i]));return t},__spreadArrays:function(){for(var t=0,i=0,e=arguments.length;i<e;i++)t+=arguments[i].length;for(var n=Array(t),o=0,i=0;i<e;i++)for(var r=arguments[i],s=0,h=r.length;s<h;s++,o++)n[o]=r[s];return n},__await:A,__asyncGenerator:function(t,i,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=e.apply(t,i||[]),r=[],s={};return n("next"),n("throw"),n("return"),s[Symbol.asyncIterator]=function(){return this},s;function n(n){o[n]&&(s[n]=function(e){return new Promise(function(t,i){1<r.push([n,e,t,i])||h(n,e)})})}function h(t,i){try{(e=o[t](i)).value instanceof A?Promise.resolve(e.value.v).then(a,l):u(r[0][2],e)}catch(t){u(r[0][3],t)}var e}function a(t){h("next",t)}function l(t){h("throw",t)}function u(t,i){t(i),r.shift(),r.length&&h(r[0][0],r[0][1])}},__asyncDelegator:function(n){var o,t={};return i("next"),i("throw",function(t){throw t}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,e){t[i]=n[i]?function(t){return(o=!o)?{value:A(n[i](t)),done:"return"===i}:e?e(t):t}:e}},__asyncValues:function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=a[Symbol.asyncIterator];return i?i.call(a):(a=P(a),t={},e("next"),e("throw"),e("return"),t[Symbol.asyncIterator]=function(){return this},t);function e(h){t[h]=a[h]&&function(s){return new Promise(function(t,i){var e,n,o,r;s=a[h](s),e=t,n=i,o=s.done,r=s.value,Promise.resolve(r).then(function(t){e({value:t,done:o})},n)})}}},__makeTemplateObject:function(t,i){return Object.defineProperty?Object.defineProperty(t,"raw",{value:i}):t.raw=i,t},__importStar:function(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)Object.hasOwnProperty.call(t,e)&&(i[e]=t[e]);return i.default=t,i},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,i){if(!i.has(t))throw new TypeError("attempted to get private field on non-instance");return i.get(t)},__classPrivateFieldSet:function(t,i,e){if(!i.has(t))throw new TypeError("attempted to set private field on non-instance");return i.set(t,e),e}}),V=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var o,e=(o=u.Triangle,m.__extends(n,o),Object.defineProperty(n.prototype,"links",{get:function(){return this._links},set:function(t){this._links=t},enumerable:!0,configurable:!0}),n.prototype.init=function(){var t;this.links=new Array,this.links.push(-1),this.links.push(-1),this.links.push(-1),this.calculateData(),this.m_WallMidpoint=new Array,this.m_WallDistance=new Array,this.m_WallMidpoint[0]=new d.Vector2f((this.pointA.x+this.pointB.x)/2,(this.pointA.y+this.pointB.y)/2),this.m_WallMidpoint[1]=new d.Vector2f((this.pointC.x+this.pointB.x)/2,(this.pointC.y+this.pointB.y)/2),this.m_WallMidpoint[2]=new d.Vector2f((this.pointC.x+this.pointA.x)/2,(this.pointC.y+this.pointA.y)/2),t=this.m_WallMidpoint[0].subtract(this.m_WallMidpoint[1]),this.m_WallDistance[0]=t.length(),t=this.m_WallMidpoint[1].subtract(this.m_WallMidpoint[2]),this.m_WallDistance[1]=t.length(),t=this.m_WallMidpoint[2].subtract(this.m_WallMidpoint[0]),this.m_WallDistance[2]=t.length()},n.prototype.requestLink=function(t,i,e){if(this.pointA.equals(t)){if(this.pointB.equals(i))return this.links[this.SIDE_AB]=e.index,!0;if(this.pointC.equals(i))return this.links[this.SIDE_CA]=e.index,!0}else if(this.pointB.equals(t)){if(this.pointA.equals(i))return this.links[this.SIDE_AB]=e.index,!0;if(this.pointC.equals(i))return this.links[this.SIDE_BC]=e.index,!0}else if(this.pointC.equals(t)){if(this.pointA.equals(i))return this.links[this.SIDE_CA]=e.index,!0;if(this.pointB.equals(i))return this.links[this.SIDE_BC]=e.index,!0}return!1},n.prototype.getLink=function(t){return this.links[t]},n.prototype.checkAndLink=function(t){-1===this.getLink(this.SIDE_AB)&&t.requestLink(this.pointA,this.pointB,this)?this.setLink(this.SIDE_AB,t):-1===this.getLink(this.SIDE_BC)&&t.requestLink(this.pointB,this.pointC,this)?this.setLink(this.SIDE_BC,t):-1===this.getLink(this.SIDE_CA)&&t.requestLink(this.pointC,this.pointA,this)&&this.setLink(this.SIDE_CA,t)},n.prototype.setLink=function(t,i){this.links[t]=i.index},n.prototype.setAndGetArrivalWall=function(t){return t===this.links[0]?this.m_ArrivalWall=0:t===this.links[1]?this.m_ArrivalWall=1:t===this.links[2]?this.m_ArrivalWall=2:-1},n.prototype.computeHeuristic=function(t){var i=Math.abs(t.x-this.center.x),e=Math.abs(t.y-this.center.y);this.h=i+e},Object.defineProperty(n.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone(),this.pointC.clone())},n);function n(t,i,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===e&&(e=null);var n=o.call(this,t,i,e)||this;return n.isOpen=!1,n.init(),n}i.Cell=e});t(V);V.Cell;var C=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});function e(t,i){this.cell=t,this.position=i}i.WayPoint=e});t(C);C.WayPoint;var b=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(Object.defineProperty(n.prototype,"data",{get:function(){return this._values[this._cursor]},set:function(t){this._values[this._cursor]=t},enumerable:!0,configurable:!0}),n.prototype.start=function(){this._cursor=0},n.prototype.hasNext=function(){return this._cursor<this._length},n.prototype.next=function(){return this._values[this._cursor++]},n);function n(t){this._values=t.toArray(),this._length=this._values.length,this._cursor=0}i.HeapIterator=e;var o=(r.prototype.peek=function(){return this._heap[1]},r.prototype.maxSize=function(){return this._size},r.prototype.put=function(t){if(this._count+1<this._size){this._heap[++this._count]=t;var i=this._count,e=i>>1,n=this._heap[i],o=void 0;if(null!=this._compare)for(;0<e&&(o=this._heap[e],0<this._compare(n,o));)this._heap[i]=o,i=e,e>>=1;else for(;0<e&&0<n-(o=this._heap[e]);)this._heap[i]=o,i=e,e>>=1;return this._heap[i]=n,!0}return!1},r.prototype.pop=function(){if(1<=this._count){var t=this._heap[1];this._heap[1]=this._heap[this._count],delete this._heap[this._count];var i=1,e=i<<1,n=this._heap[i],o=void 0;if(null!=this._compare)for(;e<this._count&&(e<this._count-1&&this._compare(this._heap[e],this._heap[e+1])<0&&e++,o=this._heap[e],this._compare(n,o)<0);)this._heap[i]=o,i=e,e<<=1;else for(;e<this._count&&(e<this._count-1&&this._heap[e]-this._heap[e+1]<0&&e++,n-(o=this._heap[e])<0);)this._heap[i]=o,i=e,e<<=1;return this._heap[i]=n,this._count--,t}return null},r.prototype.contains=function(t){for(var i=1;i<=this._count;i++)if(this._heap[i]===t)return!0;return!1},r.prototype.clear=function(){this._heap=new Array(this._size),this._count=0},r.prototype.getIterator=function(){return new e(this)},Object.defineProperty(r.prototype,"size",{get:function(){return this._count},enumerable:!0,configurable:!0}),r.prototype.isEmpty=function(){return!1},r.prototype.toArray=function(){return this._heap.slice(1,this._count+1)},r.prototype.toString=function(){return"[Heap, size="+this._size+"]"},r.prototype.dump=function(){for(var t="Heap\n{\n",i=this._count+1,e=1;e<i;e++)t+="\t"+this._heap[e]+"\n";return t+="\n}"},r);function r(t,i){void 0===i&&(i=null),this._heap=new Array(this._size=t+1),this._count=0,this._compare=null==i?function(t,i){return t-i}:i}i.Heap=o});t(b);b.HeapIterator,b.Heap;var E=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});function e(t,i){this.cell=t,this.position=i}i.WayPoint=e});t(E);E.WayPoint;var L=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(Object.defineProperty(n.prototype,"data",{get:function(){return this._values[this._cursor]},set:function(t){this._values[this._cursor]=t},enumerable:!0,configurable:!0}),n.prototype.start=function(){this._cursor=0},n.prototype.hasNext=function(){return this._cursor<this._length},n.prototype.next=function(){return this._values[this._cursor++]},n);function n(t){this._values=t.toArray(),this._length=this._values.length,this._cursor=0}i.HeapIterator=e;var o=(r.prototype.peek=function(){return this._heap[1]},r.prototype.maxSize=function(){return this._size},r.prototype.put=function(t){if(this._count+1<this._size){this._heap[++this._count]=t;var i=this._count,e=i>>1,n=this._heap[i],o=void 0;if(null!=this._compare)for(;0<e&&(o=this._heap[e],0<this._compare(n,o));)this._heap[i]=o,i=e,e>>=1;else for(;0<e&&0<n-(o=this._heap[e]);)this._heap[i]=o,i=e,e>>=1;return this._heap[i]=n,!0}return!1},r.prototype.pop=function(){if(1<=this._count){var t=this._heap[1];this._heap[1]=this._heap[this._count],delete this._heap[this._count];var i=1,e=i<<1,n=this._heap[i],o=void 0;if(null!=this._compare)for(;e<this._count&&(e<this._count-1&&this._compare(this._heap[e],this._heap[e+1])<0&&e++,o=this._heap[e],this._compare(n,o)<0);)this._heap[i]=o,i=e,e<<=1;else for(;e<this._count&&(e<this._count-1&&this._heap[e]-this._heap[e+1]<0&&e++,n-(o=this._heap[e])<0);)this._heap[i]=o,i=e,e<<=1;return this._heap[i]=n,this._count--,t}return null},r.prototype.contains=function(t){for(var i=1;i<=this._count;i++)if(this._heap[i]===t)return!0;return!1},r.prototype.clear=function(){this._heap=new Array(this._size),this._count=0},r.prototype.getIterator=function(){return new e(this)},Object.defineProperty(r.prototype,"size",{get:function(){return this._count},enumerable:!0,configurable:!0}),r.prototype.isEmpty=function(){return!1},r.prototype.toArray=function(){return this._heap.slice(1,this._count+1)},r.prototype.toString=function(){return"[Heap, size="+this._size+"]"},r.prototype.dump=function(){for(var t="Heap\n{\n",i=this._count+1,e=1;e<i;e++)t+="\t"+this._heap[e]+"\n";return t+="\n}"},r);function r(t,i){void 0===i&&(i=null),this._heap=new Array(this._size=t+1),this._count=0,this._compare=null==i?function(t,i){return t-i}:i}i.Heap=o});t(L);L.HeapIterator,L.Heap;var S=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.getCell=function(t){return this.m_CellVector[t]},n.prototype.findClosestCell=function(t){for(var i=0,e=this.m_CellVector;i<e.length;i++){var n=e[i];if(n.isPointIn(t))return n}return null},n.prototype.findPath=function(t,i){var e=(new Date).getTime();this.pathSessionId++;var n,o=new d.Vector2f(t.x,t.y),r=new d.Vector2f(i.x,i.y),s=this.findClosestCell(o),h=this.findClosestCell(r);if(null==s||null==h)return console.log("没有路径。"),null;n=s===h?[t,i]:this.buildPath(s,o,h,r),console.log("寻路时间：",(new Date).getTime()-e),console.log(n);for(var a=0,l=this.m_CellVector;a<l.length;a++){var u=l[a];u.isOpen=!1,u.parent=null,u.sessionId=0,u.h=0,u.f=0}return n},n.prototype.buildPath=function(t,i,e,n){this.openList.clear(),this.closeList.length=0,this.openList.put(e),e.f=0,e.h=0,e.isOpen=!1,e.parent=null,e.sessionId=this.pathSessionId;for(var o,r=!1,s=null;0<this.openList.size;){if(o=this.openList.pop(),this.closeList.push(o),o===t){r=!0;break}for(var h=void 0,a=0;a<3;a++)(h=o.links[a])<0||null!=(s=this.m_CellVector[h])&&(s.sessionId!==this.pathSessionId?(s.sessionId=this.pathSessionId,s.parent=o,s.isOpen=!0,s.computeHeuristic(i),s.f=o.f+s.m_WallDistance[Math.abs(a-o.m_ArrivalWall)],this.openList.put(s),s.setAndGetArrivalWall(o.index)):s.isOpen?o.f+s.m_WallDistance[Math.abs(a-o.m_ArrivalWall)]<s.f&&(s.f=o.f,s.parent=o,s.setAndGetArrivalWall(o.index)):s=null)}return r?this.getPath(i,n):null},n.prototype.getCellPath=function(){var t=new Array,i=this.closeList[this.closeList.length-1];for(t.push(i);null!=i.parent;)t.push(i.parent),i=i.parent;return t},n.prototype.getPath=function(t,i){var e=this.getCellPath();if(null==e||0===e.length)return null;var n=new Array;if(n.push(t.toPoint()),1===e.length)return n.push(i.toPoint()),n;for(var o=new E.WayPoint(e[0],t);!o.position.equals(i);)o=this.getFurthestWayPoint(o,e,i),n.push(o.position.toPoint());return n},n.prototype.getFurthestWayPoint=function(t,i,e){for(var n,o,r=t.position,s=t.cell,h=s,a=i.indexOf(s),l=s.sides[s.m_ArrivalWall],u=l.getPointA(),p=l.getPointB(),c=new _.Line2D(r,u),f=new _.Line2D(r,p),y=a+1;y<i.length;y++){if(l=(s=i[y]).sides[s.m_ArrivalWall],o=y===i.length-1?n=e:(n=l.getPointA(),l.getPointB()),!u.equals(n)){if(f.classifyPoint(n,this.EPSILON)===x.PointClassification.RIGHT_SIDE)return new E.WayPoint(h,p);c.classifyPoint(n,this.EPSILON)!==x.PointClassification.LEFT_SIDE&&(u=n,h=s,c.setPointB(u))}if(!p.equals(o)){if(c.classifyPoint(o,this.EPSILON)===x.PointClassification.LEFT_SIDE)return new E.WayPoint(h,u);f.classifyPoint(o,this.EPSILON)!==x.PointClassification.RIGHT_SIDE&&(p=o,h=s,f.setPointB(p))}}return new E.WayPoint(i[i.length-1],e)},n);function n(t){this.EPSILON=1e-6,this.pathSessionId=0,this.m_CellVector=new Array,this.m_CellVector=t,this.openList=new L.Heap(this.m_CellVector.length,function(t,i){return i.f-t.f}),this.closeList=[]}i.NavMesh=e});t(S);S.NavMesh;var I=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.createDelaunay=function(t){this.initData(t);var i,e=this.getInitOutEdge();this.lineV.push(e);do{i=this.lineV.pop();var n,o,r,s,h=this.findDT(i);null!=h&&(n=new _.Line2D(i.getPointA(),h),o=new _.Line2D(h,i.getPointB()),r=new u.Triangle(i.getPointA(),i.getPointB(),h),this.triangleV.push(r),s=void 0,this.indexOfVector(n,this.edgeV)<0&&(-1<(s=this.indexOfVector(n,this.lineV))?this.lineV.splice(s,1):this.lineV.push(n)),this.indexOfVector(o,this.edgeV)<0&&(-1<(s=this.indexOfVector(o,this.lineV))?this.lineV.splice(s,1):this.lineV.push(o)))}while(0<this.lineV.length);return this.triangleV},n.prototype.initData=function(t){var i;this.vertexV=new Array,this.edgeV=new Array;for(var e=0;e<t.length;e++)i=t[e],this.putVertex(this.vertexV,i.vertexV),this.putEdge(this.edgeV,i.vertexV);this.outEdgeVecNmu=t[0].vertexNmu,this.lineV=new Array,this.triangleV=new Array},n.prototype.getInitOutEdge=function(){var t,i=this.edgeV[0],e=0;do{t=!1,e++;for(var n=0,o=this.vertexV;n<o.length;n++){var r=o[n];if(r.equals(i.getPointA())||r.equals(i.getPointB()),i.classifyPoint(r,this.EPSILON)===x.PointClassification.ON_LINE){t=!0,i=this.edgeV[e];break}}}while(t&&e<this.outEdgeVecNmu-1);return i},n.prototype.putVertex=function(i,t){t.forEach(function(t){i.push(t)})},n.prototype.putEdge=function(t,i){if(!(i.length<3)){for(var e,n=i[0],o=1;o<i.length;o++)e=i[o],t.push(new _.Line2D(n,e)),n=e;e=i[0],t.push(new _.Line2D(n,e))}},n.prototype.indexOfVector=function(t,i){for(var e=0;e<i.length;e++)if(i[e].equals(t))return e;return-1},n.prototype.findDT=function(i){var t=i.getPointA(),e=i.getPointB(),n=new Array,o=this;if(this.vertexV.forEach(function(t){o.isVisiblePointOfLine(t,i)&&n.push(t)}),0===n.length)return null;var r=n[0],s=!1,h={};do{s=!1;for(var a=this.circumCircle(t,e,r),l=this.circleBounds(a),u=this.lineAngle(t,r,e),p=0,c=n;p<c.length;p++){var f=c[p];if(!(f.equals(t)||f.equals(e)||f.equals(r))&&!1!==l.contains(f.x,f.y)){var y=this.lineAngle(t,f,e);if(Math.abs(y)>Math.abs(u)){r=f,s=!0,h={};break}Math.abs(y)==Math.abs(u)&&(h[Math.abs(y)]=0<y?f:r)}}}while(s);return h[this.lineAngle(t,r,e)]||r},n.prototype.lineAngle=function(t,i,e){var n,o=t.x-i.x,r=t.y-i.y,s=e.x-i.x,h=e.y-i.y,a=o*s+r*h,l=(o*o+r*r)*(s*s+h*h);return 1<=(a/=Math.sqrt(l))?0:a<=-1?-Math.PI:(n=Math.acos(a),0<o*h-r*s?n:-n)},n.prototype.circleBounds=function(t){return new y.Rectangle(t.center.x-t.r,t.center.y-t.r,2*t.r,2*t.r)},n.prototype.circumCircle=function(t,i,e){var n,o,r,s,h,a,l,u,p,c,f,y;return Math.abs(t.y-i.y)<this.EPSILON&&Math.abs(i.y-e.y)<this.EPSILON?null:(n=-(i.x-t.x)/(i.y-t.y),o=-(e.x-i.x)/(e.y-i.y),r=(t.x+i.x)/2,s=(i.x+e.x)/2,h=(t.y+i.y)/2,a=(i.y+e.y)/2,f=Math.abs(i.y-t.y)<this.EPSILON?o*((c=(i.x+t.x)/2)-s)+a:Math.abs(e.y-i.y)<this.EPSILON?n*((c=(e.x+i.x)/2)-r)+h:n*((c=(n*r-o*s+a-h)/(n-o))-r)+h,p=(l=i.x-c)*l+(u=i.y-f)*u,y=Math.sqrt(p),new v(new d.Vector2f(c,f),y))},n.prototype.isVisiblePointOfLine=function(t,i){return!t.equals(i.getPointA())&&!t.equals(i.getPointB())&&i.classifyPoint(t,this.EPSILON)===x.PointClassification.RIGHT_SIDE&&!1!==this.isVisibleIn2Point(i.getPointA(),t)&&!1!==this.isVisibleIn2Point(i.getPointB(),t)},n.prototype.isVisibleIn2Point=function(t,i){for(var e=new _.Line2D(t,i),n=new d.Vector2f,o=0,r=this.edgeV;o<r.length;o++){var s=r[o];if(e.intersection(s,n)===f.LineClassification.SEGMENTS_INTERSECT&&!t.equals(n)&&!i.equals(n))return!1}return!0},n);function n(){this.EPSILON=1e-6}i.Delaunay=e;var v=function(t,i){this.center=t,this.r=i}});t(I);I.Delaunay;var B=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var p=(e.prototype.toString=function(){return this.v.toString()+"--\x3e交点："+this.i+"出点："+this.o+"主："+this.isMain+"处理："+this.p},e);function e(t,i,e){this.p=!1,this.o=!1,this.v=t,this.i=i,this.isMain=e}var n=(c.prototype.isSimplicity=function(){for(var t=new Array,i=this.vertexV.length-1,e=0;e<i;e++)t.push(new _.Line2D(this.vertexV[e],this.vertexV[e+1]));t.push(new _.Line2D(this.vertexV[i],this.vertexV[0]));for(var n=new d.Vector2f,o=0,r=t;o<r.length;o++)for(var s=r[o],h=0;h<t.length;h++)if(!s.equals(t[h])&&s.intersection(t[h],n)===f.LineClassification.SEGMENTS_INTERSECT&&!(n.equals(s.getPointA())||n.equals(s.getPointB())||n.equals(t[h].getPointA())||n.equals(t[h].getPointB())))return!1;return!0},c.prototype.cw=function(){!1===this.isCW()&&this.vertexV.reverse()},c.prototype.isCW=function(){if(null==this.vertexV||this.vertexV.length<0)return!1;for(var t=this.vertexV[0],i=0,e=1;e<this.vertexV.length;e++)(t.y>this.vertexV[e].y||t.y===this.vertexV[e].y&&t.x>this.vertexV[e].x)&&(t=this.vertexV[e],i=e);var n=0<=i-1?i-1:this.vertexV.length-1,o=i+1>=this.vertexV.length?0:i+1,r=this.vertexV[n],s=this.vertexV[o];return c.multiply(r,s,t)<0},c.multiply=function(t,i,e){return(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)},c.prototype.rectangle=function(){if(null==this.vertexV||this.vertexV.length<0)return null;if(null!=this.rect)return this.rect;for(var t,i=this.vertexV[0].x,e=this.vertexV[0].x,n=this.vertexV[0].y,o=this.vertexV[0].y,r=1;r<this.vertexV.length;r++)(t=this.vertexV[r]).x<i&&(i=t.x),t.x>e&&(e=t.x),t.y<n&&(n=t.y),t.y>o&&(o=t.y);return this.rect=new y.Rectangle(i,n,e-i,o-n),this.rect},c.prototype.union=function(t){var i=this.rectangle().intersection(t.rectangle());if(!i||!0===i.isEmpty())return null;for(var e,n=new Array,o=new Array,r=0;r<this.vertexV.length;r++)e=new p(this.vertexV[r],!1,!0),0<r&&(n[r-1].next=e),n.push(e);for(var s=0;s<t.vertexV.length;s++)e=new p(t.vertexV[s],!1,!1),0<s&&(o[s-1].next=e),o.push(e);return 0<c.intersectPoint(n,o)?this.linkToPolygon(n,o):null},c.prototype.complement=function(t){var i=this.rectangle();if(i.containsRect(t.rectangle()))return t;var e=i.intersection(t.rectangle());if(!e||!0===e.isEmpty())return null;for(var n,o=new Array,r=new Array,s=0;s<this.vertexV.length;s++)n=new p(this.vertexV[s],!1,!0),0<s&&(o[s-1].next=n),o.push(n);for(var h=0;h<t.vertexV.length;h++)n=new p(t.vertexV[h],!1,!1),0<h&&(r[h-1].next=n),r.push(n);if(0<c.intersectPoint(o,r)){var a=new Array;r.forEach(function(t){i.contains(t.v.x,t.v.y)&&a.push(t.v)});var l=new c(a.length,a);return l.cw(),l}return null},c.prototype.linkToPolygon=function(e,n){var o=new Array;return e.forEach(function(t){if(!0===t.i&&!1===t.p){for(var i=new Array;t&&((t.p=!0)===t.i&&(!(t.other.p=!0)===t.o?!0===t.isMain&&(t=t.other):!1===t.isMain&&(t=t.other)),i.push(t.v),!(t=null==t.next?t.isMain?e[0]:n[0]:t.next).v.equals(i[0])););o.push(new c(i.length,i))}}),o},c.intersectPoint=function(t,i){for(var e,n,o,r,s,h=0,a=t[0];null!=a;){for(n=null==a.next?new _.Line2D(a.v,t[0].v):new _.Line2D(a.v,a.next.v),e=i[0],s=!1;null!=e;){if(o=null==e.next?new _.Line2D(e.v,i[0].v):new _.Line2D(e.v,e.next.v),r=new d.Vector2f,n.intersection(o,r)===f.LineClassification.SEGMENTS_INTERSECT&&-1===c.getNodeIndex(t,r)){h++;var l=new p(r,!0,!0),u=new p(r,!0,!1);t.push(l),i.push(u),((l.other=u).other=l).next=a.next,a.next=l,u.next=e.next,e.next=u,n.classifyPoint(o.getPointB())===x.PointClassification.RIGHT_SIDE&&(l.o=!0,u.o=!0),s=!0;break}e=e.next}!1===s&&(a=a.next)}return h},c.getNodeIndex=function(t,i){for(var e=0;e<t.length;e++)if(t[e].v.equals(i))return e;return-1},c.prototype.toString=function(){for(var t="Polygon:",i=0;i<this.vertexV.length;i++)t+=" -> "+this.vertexV[i];return t},c);function c(t,i){this.vertexNmu=t,this.vertexV=i}i.Polygon=n});t(B);B.Polygon;var O=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var o,e=(o=u.Triangle,m.__extends(n,o),Object.defineProperty(n.prototype,"links",{get:function(){return this._links},set:function(t){this._links=t},enumerable:!0,configurable:!0}),n.prototype.init=function(){var t;this.links=new Array,this.links.push(-1),this.links.push(-1),this.links.push(-1),this.calculateData(),this.m_WallMidpoint=new Array,this.m_WallDistance=new Array,this.m_WallMidpoint[0]=new d.Vector2f((this.pointA.x+this.pointB.x)/2,(this.pointA.y+this.pointB.y)/2),this.m_WallMidpoint[1]=new d.Vector2f((this.pointC.x+this.pointB.x)/2,(this.pointC.y+this.pointB.y)/2),this.m_WallMidpoint[2]=new d.Vector2f((this.pointC.x+this.pointA.x)/2,(this.pointC.y+this.pointA.y)/2),t=this.m_WallMidpoint[0].subtract(this.m_WallMidpoint[1]),this.m_WallDistance[0]=t.length(),t=this.m_WallMidpoint[1].subtract(this.m_WallMidpoint[2]),this.m_WallDistance[1]=t.length(),t=this.m_WallMidpoint[2].subtract(this.m_WallMidpoint[0]),this.m_WallDistance[2]=t.length()},n.prototype.requestLink=function(t,i,e){if(this.pointA.equals(t)){if(this.pointB.equals(i))return this.links[this.SIDE_AB]=e.index,!0;if(this.pointC.equals(i))return this.links[this.SIDE_CA]=e.index,!0}else if(this.pointB.equals(t)){if(this.pointA.equals(i))return this.links[this.SIDE_AB]=e.index,!0;if(this.pointC.equals(i))return this.links[this.SIDE_BC]=e.index,!0}else if(this.pointC.equals(t)){if(this.pointA.equals(i))return this.links[this.SIDE_CA]=e.index,!0;if(this.pointB.equals(i))return this.links[this.SIDE_BC]=e.index,!0}return!1},n.prototype.getLink=function(t){return this.links[t]},n.prototype.checkAndLink=function(t){-1===this.getLink(this.SIDE_AB)&&t.requestLink(this.pointA,this.pointB,this)?this.setLink(this.SIDE_AB,t):-1===this.getLink(this.SIDE_BC)&&t.requestLink(this.pointB,this.pointC,this)?this.setLink(this.SIDE_BC,t):-1===this.getLink(this.SIDE_CA)&&t.requestLink(this.pointC,this.pointA,this)&&this.setLink(this.SIDE_CA,t)},n.prototype.setLink=function(t,i){this.links[t]=i.index},n.prototype.setAndGetArrivalWall=function(t){return t===this.links[0]?this.m_ArrivalWall=0:t===this.links[1]?this.m_ArrivalWall=1:t===this.links[2]?this.m_ArrivalWall=2:-1},n.prototype.computeHeuristic=function(t){var i=Math.abs(t.x-this.center.x),e=Math.abs(t.y-this.center.y);this.h=i+e},Object.defineProperty(n.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.pointA.clone(),this.pointB.clone(),this.pointC.clone())},n);function n(t,i,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===e&&(e=null);var n=o.call(this,t,i,e)||this;return n.isOpen=!1,n.init(),n}i.Cell=e});t(O);O.Cell;var D=i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(n.prototype.getCell=function(t){return this.m_CellVector[t]},n.prototype.findClosestCell=function(t){for(var i=0,e=this.m_CellVector;i<e.length;i++){var n=e[i];if(n.isPointIn(t))return n}return null},n.prototype.findPath=function(t,i){var e=(new Date).getTime();this.pathSessionId++;var n,o=new d.Vector2f(t.x,t.y),r=new d.Vector2f(i.x,i.y),s=this.findClosestCell(o),h=this.findClosestCell(r);if(null==s||null==h)return console.log("没有路径。"),null;n=s===h?[t,i]:this.buildPath(s,o,h,r),console.log("寻路时间：",(new Date).getTime()-e),console.log(n);for(var a=0,l=this.m_CellVector;a<l.length;a++){var u=l[a];u.isOpen=!1,u.parent=null,u.sessionId=0,u.h=0,u.f=0}return n},n.prototype.buildPath=function(t,i,e,n){this.openList.clear(),this.closeList.length=0,this.openList.put(e),e.f=0,e.h=0,e.isOpen=!1,e.parent=null,e.sessionId=this.pathSessionId;for(var o,r=!1,s=null;0<this.openList.size;){if(o=this.openList.pop(),this.closeList.push(o),o===t){r=!0;break}for(var h=void 0,a=0;a<3;a++)(h=o.links[a])<0||null!=(s=this.m_CellVector[h])&&(s.sessionId!==this.pathSessionId?(s.sessionId=this.pathSessionId,s.parent=o,s.isOpen=!0,s.computeHeuristic(i),s.f=o.f+s.m_WallDistance[Math.abs(a-o.m_ArrivalWall)],this.openList.put(s),s.setAndGetArrivalWall(o.index)):s.isOpen?o.f+s.m_WallDistance[Math.abs(a-o.m_ArrivalWall)]<s.f&&(s.f=o.f,s.parent=o,s.setAndGetArrivalWall(o.index)):s=null)}return r?this.getPath(i,n):null},n.prototype.getCellPath=function(){var t=new Array,i=this.closeList[this.closeList.length-1];for(t.push(i);null!=i.parent;)t.push(i.parent),i=i.parent;return t},n.prototype.getPath=function(t,i){var e=this.getCellPath();if(null==e||0===e.length)return null;var n=new Array;if(n.push(t.toPoint()),1===e.length)return n.push(i.toPoint()),n;for(var o=new E.WayPoint(e[0],t);!o.position.equals(i);)o=this.getFurthestWayPoint(o,e,i),n.push(o.position.toPoint());return n},n.prototype.getFurthestWayPoint=function(t,i,e){for(var n,o,r=t.position,s=t.cell,h=s,a=i.indexOf(s),l=s.sides[s.m_ArrivalWall],u=l.getPointA(),p=l.getPointB(),c=new _.Line2D(r,u),f=new _.Line2D(r,p),y=a+1;y<i.length;y++){if(l=(s=i[y]).sides[s.m_ArrivalWall],o=y===i.length-1?n=e:(n=l.getPointA(),l.getPointB()),!u.equals(n)){if(f.classifyPoint(n,this.EPSILON)===x.PointClassification.RIGHT_SIDE)return new E.WayPoint(h,p);c.classifyPoint(n,this.EPSILON)!==x.PointClassification.LEFT_SIDE&&(u=n,h=s,c.setPointB(u))}if(!p.equals(o)){if(c.classifyPoint(o,this.EPSILON)===x.PointClassification.LEFT_SIDE)return new E.WayPoint(h,u);f.classifyPoint(o,this.EPSILON)!==x.PointClassification.RIGHT_SIDE&&(p=o,h=s,f.setPointB(p))}}return new E.WayPoint(i[i.length-1],e)},n);function n(t){this.EPSILON=1e-6,this.pathSessionId=0,this.m_CellVector=new Array,this.m_CellVector=t,this.openList=new L.Heap(this.m_CellVector.length,function(t,i){return i.f-t.f}),this.closeList=[]}i.NavMesh=e});t(D);D.NavMesh;return t(i(function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var e=(s.prototype.pushFrame=function(t){for(var i=new Array,e=0,n=t;e<n.length;e++){var o=n[e];i.push(new d.Vector2f(o.x,o.y))}var r=new B.Polygon(i.length,i);r.cw(),this.polygonV.push(r)},s.pointsConvertToVector=function(t){for(var i=new Array,e=0,n=t;e<n.length;e++){var o=n[e],r=new d.Vector2f(o.x,o.y);i.push(r)}return i},s.prototype.addPolygon=function(t){var i=new B.Polygon(t.length,t);i.cw();var e=this.polygonV[0].complement(i);null!=e&&this.polygonV.push(e)},s.prototype.unionAll=function(){for(var t=1;t<this.polygonV.length;t++)for(var i=this.polygonV[t],e=1;e<this.polygonV.length;e++){var n=this.polygonV[e];if(i!==n&&i.isCW()&&n.isCW()){var o=i.union(n);if(null!=o&&0<o.length){console.log("delete"),this.polygonV.splice(this.polygonV.indexOf(i),1),this.polygonV.splice(this.polygonV.indexOf(n),1);for(var r=0,s=o;r<s.length;r++){var h=s[r];this.polygonV.push(h)}t=1;break}}}},s.linkCells=function(t){for(var i=0,e=t;i<e.length;i++)for(var n=e[i],o=0,r=t;o<r.length;o++){var s=r[o];n&&s&&n!==s&&n.checkAndLink(s)}},s.prototype.buildTriangle=function(){this.unionAll();var t,i,e=new I.Delaunay;this.triangleV=e.createDelaunay(this.polygonV),this.cellV=new Array;for(var n=0;n<this.triangleV.length;n++)t=this.triangleV[n],(i=new O.Cell(t.getVertex(0),t.getVertex(1),t.getVertex(2))).index=n,this.cellV.push(i);s.linkCells(this.cellV)},s.prototype.findPath=function(t,i){var e=new o.Point(t[0],t[1]),n=new o.Point(i[0],i[1]);return new D.NavMesh(this.cellV).findPath(e,n)},s);function s(t,i){this.polygonV=new Array,this.pushFrame(t);for(var e=0,n=i;e<n.length;e++){var o=n[e],r=s.pointsConvertToVector(o);this.addPolygon(r)}this.buildTriangle()}t.exports=e}))}();
